{
  "name": "hearbeat_rate_value",
  "description": "Heartbeat Rate",
  "continue": false,
  "active": false,
  "constraint": {
    "WHERE": {
      "type": "AND",
      "operators": [
        {
          "type": "le",
          "first": "${_variables.hearbeat_rate.numberdays}",
          "second": "10"
        }
      ]
    },
    "WITH": {
      "numberdays": {
        "from": "${event.payload.oids.\"DISMAN-EVENT-MIB::sysUpTimeInstance\".content}",
        "regex": {
          "match": ".*Uptime\\s+(\\d+).*",
          "group_match_idx": 1,
          "all_matches": false
        }
      }
    }
  },
  "actions": [
    {
      "id": "monitoring",
      "payload": {
        "host_creation_payload": {
          "imports": "generic-passive-host",
          "vars": {
            "created_by": "tornado"
          },
          "address": "127.0.0.1",
          "object_name": "${event.payload.oids.\"SNMPv2-MIB::sysName.0\".content}",
          "object_type": "Object"
        },
        "action_name": "create_and_or_process_service_passive_check_result",
        "service_creation_payload": {
          "object_name": "Heartbeat",
          "imports": "generic-passive-service",
          "host": "${event.payload.oids.\"SNMPv2-MIB::sysName.0\".content}",
          "object_type": "Object",
          "vars": {
            "created_by": "tornado"
          }
        },
        "process_check_result_payload": {
          "performance_data": [],
          "exit_status": "2",
          "plugin_output": "Critical Hearbeat value: ${event.payload.oids.\"DISMAN-EVENT-MIB::sysUpTimeInstance\".content}",
          "service": "${event.payload.oids.\"SNMPv2-MIB::sysName.0\".content}!Heartbeat",
          "type": "Service"
        }
      }
    }
  ]
}