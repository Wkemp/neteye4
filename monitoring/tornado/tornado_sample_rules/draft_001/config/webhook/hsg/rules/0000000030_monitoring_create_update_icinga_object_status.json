{
  "name": "monitoring_create_update_icinga_object_status",
  "description": "Monitoring Result: Create or Update Icinga2 Object status",
  "continue": true,
  "active": true,
  "constraint": {
    "WHERE": {
      "type": "AND",
      "operators": [
        {
          "type": "regex",
          "regex": ".*hsg.*",
          "target": "${event.type}"
        }
      ]
    },
    "WITH": {}
  },
  "actions": [
    {
      "id": "monitoring",
      "payload": {
        "service_creation_payload": {
          "object_type": "Object",
          "object_name": "PING",
          "host": "${event.payload.data.host_name}",
          "check_command": "ping"
        },
        "host_creation_payload": {
          "vars": {
            "location": "Bozen"
          },
          "address": "${event.payload.data.host_address}",
          "object_name": "${event.payload.data.host_name}",
          "object_type": "Object",
          "check_command": "hostalive"
        },
        "action_name": "create_and_or_process_service_passive_check_result",
        "process_check_result_payload": {
          "type": "Service",
          "service": "${event.payload.data.host_name}!PING",
          "plugin_output": "Output message",
          "exit_status": "2"
        }
      }
    },
    {
      "id": "smart_monitoring_check_result",
      "payload": {
        "host": "${event.payload.data.host_name}",
        "check_result": "Result",
        "service": "PING"
      }
    }
  ]
}